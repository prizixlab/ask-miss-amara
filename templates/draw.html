<!doctype html>
<meta charset="utf-8">
<link rel="stylesheet" href="https://unpkg.com/mvp.css">
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
<meta name="theme-color" content="#cdb4db">
<main>
  <header style="display:flex;justify-content:space-between;align-items:center">
    <h1>Daily Draws</h1>
    <nav><a href="/">Home</a> · <a href="/app">Ask</a> · <a href="/daily">Aura</a> · <a href="/daily/draw">Card/Rune</a> · <a href="/moon">Moon</a> · <a href="/tracker">Tracker</a></nav>
  </header>

 
   <section>
  <h2>{{ kind|title }} Draw</h2>

  {% if image_url %}
    <img src="{{ image_url }}" alt="{{ kind }} image" style="max-width:80%;border-radius:12px;margin:20px 0;">
  {% else %}
    <p>No images found in static/{{ kind }}/</p>
  {% endif %}

  <div>
    <a class="btn" href="/draw/{{ kind }}" style="display:inline-block;padding:10px 20px;background:#eee;border-radius:8px;text-decoration:none;margin:10px;">Draw Again</a>
  </div>
</section>
<form id="ask-form" action="/ask/{{ kind }}" method="post" style="margin-top:16px;">
  <input name="question" placeholder="Ask a question for this {{ kind }}…" style="width:70%;padding:10px;border-radius:8px;border:1px solid #ddd;">
  <button type="submit" style="padding:10px 16px;border-radius:8px;margin-left:8px;">Ask Miss Amara</button>
</form>

<div id="answer" style="max-width:800px;margin:16px auto;text-align:left;line-height:1.5;"></div>

<script>
  const form = document.getElementById('ask-form');
  const answerBox = document.getElementById('answer');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    answerBox.textContent = 'Reading…';
    const res = await fetch(form.action, { method: 'POST', body: new FormData(form) });
    const data = await res.json();
    answerBox.textContent = data.answer || data.error || 'No response.';
  });
</script>

  
  <hr>
  <section>
    <h3>Recent history</h3>
    <details><summary>Tarot — last 10</summary>
      {% for d in tarot_hist %}<p><b>{{ d.created_at.date() }}</b> — {{ d.name }} — <small>{{ d.keywords }}</small></p>{% endfor %}
    </details>
    <details><summary>Runes — last 10</summary>
      {% for d in rune_hist %}<p><b>{{ d.created_at.date() }}</b> — {{ d.name }} — <small>{{ d.keywords }}</small></p>{% endfor %}
    </details>
  </section>
</main>
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('{{ url_for("static", filename="service-worker.js") }}');
}
</script>
